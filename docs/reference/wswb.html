<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Watershed water balance model — wswb • medfateland</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Watershed water balance model — wswb" />
<meta property="og:description" content="A distributed hydrological model that simulates daily water balance on the cells of a watershed while accounting for overland runoff, subsurface flow and groundwater flow between cells." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfateland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Watershed water balance model</h1>
    
    <div class="hidden name"><code>wswb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A distributed hydrological model that simulates daily water balance on the cells of a watershed while accounting for overland runoff, subsurface flow and groundwater flow between cells.</p>
    </div>

    <pre class="usage"><span class='fu'>wswb</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>SpParams</span>, <span class='va'>meteo</span>, <span class='va'>dates</span>,
     summaryFreq <span class='op'>=</span> <span class='st'>"years"</span>,
     spwbcontrol <span class='op'>=</span> <span class='fu'>medfate</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/medfate/man/defaultControl.html'>defaultControl</a></span><span class='op'>(</span><span class='op'>)</span>,
     correctionFactors <span class='op'>=</span> <span class='fu'><a href='defaultWatershedCorrectionFactors.html'>defaultWatershedCorrectionFactors</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>An object of class <code><a href='DistributedWatershed-class.html'>DistributedWatershed-class</a></code>.</p></td>
    </tr>
    <tr>
      <th>SpParams</th>
      <td><p>A data frame with species parameters (see <code><a href='https://rdrr.io/pkg/medfate/man/SpParams.html'>SpParamsMED</a></code>).</p></td>
    </tr>
    <tr>
      <th>meteo</th>
      <td><p>Input meteorological data (see section details).</p></td>
    </tr>
    <tr>
      <th>dates</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/Dates.html'>Date</a></code> object describing the days of the period to be modeled.</p></td>
    </tr>
    <tr>
      <th>summaryFreq</th>
      <td><p>Frequency in which summary layers will be produced (e.g. "years", "months", ...) (see <code><a href='https://rdrr.io/r/base/cut.POSIXt.html'>cut.Date</a></code>).</p></td>
    </tr>
    <tr>
      <th>spwbcontrol</th>
      <td><p>A list of control parameters (see <code><a href='https://rdrr.io/pkg/medfate/man/defaultControl.html'>defaultControl</a></code>) for function <code><a href='https://rdrr.io/pkg/medfate/man/spwb.html'>spwb</a></code>.</p></td>
    </tr>
    <tr>
      <th>correctionFactors</th>
      <td><p>A list of watershed correction factors for hydraulic parameters.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Function <code>wswb</code> requires daily meteorological data over grid cells. The user may supply four different inputs:</p><ol>
<li><p>An object of <code>SpatialPixelsMeteorology-class</code>.</p></li>
<li><p>An object of <code>MeteorologyInterpolationData-class</code>.</p></li>
<li><p>A data frame with information regarding where to read meteorological data.</p></li>
<li><p>A data frame with meteorological data common for all cells of the grid.</p></li>
</ol><p>In the case of (1), all the spatio-temporal variation of weather is already supplied by the user. In the case of (2), interpolation of weather is done over each grid cell every simulated day. In the case of (3) weather maps are read for each day. Finally, in the case of (4) spatial variation of weather is not considered.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class 'wswb' with the following elements:</p><ul>
<li><p><code>coords</code>: A matrix of pixel coordinates.</p></li>
<li><p><code>coords.nrs</code>: Inherited from <code>SpatialPointsDataFrame</code> but not used.</p></li>
<li><p><code>grid</code>: The <code>GridTopology</code> object corresponding to the simulated area.</p></li>
<li><p><code>grid.index</code>: Index of points in full grid.</p></li>
<li><p><code>bbox</code>: Object of class <code>"matrix"</code> with the boundary box.</p></li>
<li><p><code>WatershedBalance</code>: A data frame with as many rows as summary points and where columns are components of the water balance at the watershed level (i.e., rain, snow, interception, infiltration, soil evaporation, plant transpiration, ...).</p></li>
<li><p><code>WatershedSoilBalance</code>: A data frame with as many rows as summary points and where columns are components of the water balance at the watershed level restricted to those cells with a soil definition.</p></li>
<li><p><code>CellBalance</code>: A list of matrices (each with as many rows as cells and as many columns as summary points) representing the water balance for each cell:
   <ul>
<li><p><code>Rain</code>: Rainfall (in mm).</p></li>
<li><p><code>Snow</code>: Snowfall (in mm).</p></li>
<li><p><code>Snowmelt</code>: Snow melt (in mm).</p></li>
<li><p><code>Interception</code>: Rainfall interception (in mm).</p></li>
<li><p><code>NetRain</code>: Net rain, i.e. throughfall, (in mm).</p></li>
<li><p><code>Runon</code>: The amount of water imported from other cells via surface runoff (in mm).</p></li>
<li><p><code>Runoff</code>: The amount of water exported via surface runoff (in mm).</p></li>
<li><p><code>Infiltration</code>: The amount of water infiltrating into the soil (in mm).</p></li>
<li><p><code>DeepDrainage</code>: The amount of water draining from soil to the aquifer via deep drainage (in mm).</p></li>
<li><p><code>SaturationExcess</code>: The amount of water that reaches the soil surface because of soil saturation (in mm).</p></li>
<li><p><code>AquiferDischarge</code>: The amount of water that reaches deepest soil layer from a saturated aquifer (in mm).</p></li>
<li><p><code>SubsurfaceInput</code>: The amount of water that reaches the soil from adjacent cells via subsurface flow (in mm).</p></li>
<li><p><code>SubsurfaceOutput</code>: The amount of water that leaves the soil towards adjacent cells via subsurface flow (in mm).</p></li>
<li><p><code>GroundwaterInput</code>: The amount of water that reaches the aquifer from adjacent cells via groundwater flow (in mm).</p></li>
<li><p><code>GroundwaterOutput</code>: The amount of water that leaves the aquifer towards adjacent cells via groundwater flow (in mm).</p></li>
<li><p><code>SoilEvaporation</code>: Bare soil evaporation (in mm).</p></li>
<li><p><code>Transpiration</code>: Plant transpiration (in mm).</p></li>
</ul></p></li>
<li><p><code>CellState</code>: A list of matrices (each with as many rows as cells and as many columns as summary points) representing the average soil state for each cell:
   <ul>
<li><p><code>SWE</code>: Snow water equivalent (in mm) of the snowpack.</p></li>
<li><p><code>Psi1</code>: Soil water potential of the topmost layer (in MPa).</p></li>
<li><p><code>SoilVol</code>: Soil water volume integrated across vertical layers (in mm).</p></li>
<li><p><code>WTD</code>: Water table depth (in mm from surface).</p></li>
</ul></p></li>
<li><p><code>DailyRunoff</code>: A matrix with daily runoff (in m3/day) at each of the outlet cells of the landscape.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Miquel De Cáceres Ainsa, CREAF.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.wswb.html'>plot.wswb</a></code>, <code><a href='https://rdrr.io/pkg/medfate/man/spwb.html'>spwb</a></code>, <code><a href='medfate spatial.html'>spwbpoints</a></code>, <code><a href='DistributedWatershed-class.html'>DistributedWatershed-class</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"examplewatershed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"examplemeteo"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"SpParamsMED"</span><span class='op'>)</span>

<span class='va'>dates</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2001-01-01"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2001-03-31"</span><span class='op'>)</span>, by<span class='op'>=</span><span class='st'>"day"</span><span class='op'>)</span>

<span class='va'>res</span> <span class='op'>=</span> <span class='fu'>wswb</span><span class='op'>(</span><span class='va'>examplewatershed</span>, <span class='va'>SpParamsMED</span>, <span class='va'>examplemeteo</span>, dates <span class='op'>=</span> <span class='va'>dates</span>, summaryFreq <span class='op'>=</span> <span class='st'>"month"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


