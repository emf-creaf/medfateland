<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Watershed simulations — spwb_land • medfateland</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Watershed simulations — spwb_land"><meta property="og:description" content="Functions to perform simulations on a watershed described by a set of connected grid cells"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfateland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Watershed simulations</h1>
    
    <div class="hidden name"><code>spwb_land.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to perform simulations on a watershed described by a set of connected grid cells</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spwb_land</span><span class="op">(</span></span>
<span>  <span class="va">sf</span>,</span>
<span>  <span class="va">SpParams</span>,</span>
<span>  meteo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CO2ByYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  summary_frequency <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  local_control <span class="op">=</span> <span class="fu">medfate</span><span class="fu">::</span><span class="fu"><a href="https://emf-creaf.github.io/medfate/reference/defaultControl.html" class="external-link">defaultControl</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  correction_factors <span class="op">=</span> <span class="fu"><a href="default_watershed_correction_factors.html">default_watershed_correction_factors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">growth_land</span><span class="op">(</span></span>
<span>  <span class="va">sf</span>,</span>
<span>  <span class="va">SpParams</span>,</span>
<span>  meteo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CO2ByYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  summary_frequency <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  local_control <span class="op">=</span> <span class="fu">medfate</span><span class="fu">::</span><span class="fu"><a href="https://emf-creaf.github.io/medfate/reference/defaultControl.html" class="external-link">defaultControl</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  correction_factors <span class="op">=</span> <span class="fu"><a href="default_watershed_correction_factors.html">default_watershed_correction_factors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fordyn_land</span><span class="op">(</span></span>
<span>  <span class="va">sf</span>,</span>
<span>  <span class="va">SpParams</span>,</span>
<span>  meteo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CO2ByYear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  local_control <span class="op">=</span> <span class="fu">medfate</span><span class="fu">::</span><span class="fu"><a href="https://emf-creaf.github.io/medfate/reference/defaultControl.html" class="external-link">defaultControl</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  correction_factors <span class="op">=</span> <span class="fu"><a href="default_watershed_correction_factors.html">default_watershed_correction_factors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  management_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sf</dt>
<dd><p>An object of class <code>sf</code> with the following columns:</p><ul><li><p><code>geometry</code>: Spatial geometry.</p></li>
<li><p><code>id</code>: Cell ids (normally row number).</p></li>
<li><p><code>elevation</code>: Elevation above sea level (in m).</p></li>
<li><p><code>slope</code>: Slope (in degrees).</p></li>
<li><p><code>aspect</code>: Aspect (in degrees).</p></li>
<li><p><code>land_cover_type</code>: Land cover type of each grid cell (values should be 'wildland', 'agriculture', 'rock', 'artificial' or 'water').</p></li>
<li><p><code>forest</code>: Objects of class <code>forest</code>.</p></li>
<li><p><code>soil</code>: Objects of class <code>soil</code> or data frames of physical properties.</p></li>
<li><p><code>state</code>: Objects of class <code>spwbInput</code> or <code>growthInput</code> (optional).</p></li>
<li><p><code>meteo</code>: Data frames with weather data (required if parameter <code>meteo = NULL</code>).</p></li>
<li><p><code>crop_factor</code>: Crop evapo-transpiration factor. Only required for 'agriculture' land cover type.</p></li>
<li><p><code>waterOrder</code>: Integer vector indicating cell processing order.</p></li>
<li><p><code>waterQ</code>: A list of water discharge values to neighbors.</p></li>
<li><p><code>queenNeigh</code>: A list of integers identifying the (up to 8) queen neighbors, for each cell.</p></li>
<li><p><code>channel</code>: A logical vector indicating whether each cell belongs to the channel network.</p></li>
<li><p><code>depth_to_bedrock</code>: Depth to bedrock (mm).</p></li>
<li><p><code>bedrock_conductivity</code>: Bedrock (saturated) conductivity (in m·day-1).</p></li>
<li><p><code>bedrock_porosity</code>: Bedrock porosity.</p></li>
<li><p><code>snowpack</code>: A numeric vector with the snow water equivalent content of the snowpack in each cell.</p></li>
<li><p><code>aquifer</code>: A numeric vector with the water content of the aquifer in each cell.</p></li>
<li><p><code>represented_area</code>: Area represented by each cell (in m2).</p></li>
<li><p><code>management_arguments</code>: Lists with management arguments (optional, relevant for <code>fordyn_land</code> only).</p></li>
</ul></dd>


<dt>SpParams</dt>
<dd><p>A data frame with species parameters (see <code>SpParamsMED</code>).</p></dd>


<dt>meteo</dt>
<dd><p>Input meteorological data (see <code><a href="spwb_spatial.html">spwb_spatial</a></code>).</p></dd>


<dt>dates</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/Dates.html" class="external-link">Date</a></code> object describing the days of the period to be modeled.</p></dd>


<dt>CO2ByYear</dt>
<dd><p>A named numeric vector with years as names and atmospheric CO2 concentration (in ppm) as values. Used to specify annual changes in CO2 concentration along the simulation (as an alternative to specifying daily values in <code>meteo</code>).</p></dd>


<dt>summary_frequency</dt>
<dd><p>Frequency in which summary layers will be produced (e.g. "years", "months", ...) (see <code><a href="https://rdrr.io/r/base/cut.POSIXt.html" class="external-link">cut.Date</a></code>).
In <code>fordyn_land</code> summaries are always produced at monthly resolution.</p></dd>


<dt>local_control</dt>
<dd><p>A list of control parameters (see <code>defaultControl</code>) for function <code>spwb_day</code> or <code>growth_day</code>.</p></dd>


<dt>correction_factors</dt>
<dd><p>A list of watershed correction factors for hydraulic parameters.</p></dd>


<dt>progress</dt>
<dd><p>Boolean flag to display progress information for simulations.</p></dd>


<dt>management_function</dt>
<dd><p>A function that implements forest management actions (see <code>fordyn</code>).
of such lists, one per spatial unit.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Functions <code>spwb_land</code>, <code>growth_land</code> and <code>fordyn_land</code> return a list of class of the same name as the function with the following elements:</p><ul><li><p><code>sf</code>: An object of class <code>sf</code>, similar to the output of <code><a href="spwb_spatial.html">spwb_spatial</a></code>,
with the following columns:
</p><ul><li><p><code>geometry</code>: Spatial geometry.</p></li>
<li><p><code>id</code>: Cell id, taken from the input.</p></li>
<li><p><code>state</code>: A list of model input objects for each simulated stand.</p></li>
<li><p><code>aquifer</code>: A numeric vector with the water volume in the aquifer of each cell.</p></li>
<li><p><code>snowpack</code>: A numeric vector with the snowpack water equivalent volume of each cell.</p></li>
<li><p><code>summary</code>: A list of cell summaries, containing the following variables:
</p><ul><li><p><code>Rain</code>: Rainfall (in mm).</p></li>
<li><p><code>Snow</code>: Snowfall (in mm).</p></li>
<li><p><code>Snowmelt</code>: Snow melt (in mm).</p></li>
<li><p><code>Interception</code>: Rainfall interception (in mm).</p></li>
<li><p><code>NetRain</code>: Net rain, i.e. throughfall, (in mm).</p></li>
<li><p><code>Runon</code>: The amount of water imported from other cells via surface runoff (in mm).</p></li>
<li><p><code>Runoff</code>: The amount of water exported via surface runoff (in mm).</p></li>
<li><p><code>Infiltration</code>: The amount of water infiltrating into the soil (in mm).</p></li>
<li><p><code>DeepDrainage</code>: The amount of water draining from soil to the aquifer via deep drainage (in mm).</p></li>
<li><p><code>SaturationExcess</code>: The amount of water that reaches the soil surface because of soil saturation (in mm).</p></li>
<li><p><code>AquiferDischarge</code>: The amount of water that reaches deepest soil layer from a saturated aquifer (in mm).</p></li>
<li><p><code>SubsurfaceInput</code>: The amount of water that reaches the soil from adjacent cells via subsurface flow (in mm).</p></li>
<li><p><code>SubsurfaceOutput</code>: The amount of water that leaves the soil towards adjacent cells via subsurface flow (in mm).</p></li>
<li><p><code>GroundwaterInput</code>: The amount of water that reaches the aquifer from adjacent cells via groundwater flow (in mm).</p></li>
<li><p><code>GroundwaterOutput</code>: The amount of water that leaves the aquifer towards adjacent cells via groundwater flow (in mm).</p></li>
<li><p><code>SoilEvaporation</code>: Bare soil evaporation (in mm).</p></li>
<li><p><code>Transpiration</code>: Plant transpiration (in mm).</p></li>
<li><p><code>SWE</code>: Snow water equivalent (in mm) of the snowpack.</p></li>
<li><p><code>Psi1</code>: Soil water potential of the topmost layer (in MPa).</p></li>
<li><p><code>SoilVol</code>: Soil water volume integrated across vertical layers (in mm).</p></li>
<li><p><code>WTD</code>: Water table depth (in mm from surface).</p></li>
</ul></li>
</ul>
In function <code>fordyn_land</code> the <code>sf</code> object contains additional columns:
<ul><li><p><code>forest</code>: A list of <code>forest</code> objects for each simulated stand (only in <code>fordynspatial</code>), to be used in subsequent simulations (see <code><a href="update_landscape.html">update_landscape</a></code>).</p></li>
<li><p><code>management_arguments</code>: A list of management arguments for each simulated stand (only in <code>fordynspatial</code>), to be used in subsequent simulations (see <code><a href="update_landscape.html">update_landscape</a></code>).</p></li>
<li><p><code>tree_table</code>: A list of data frames for each simulated stand, containing the living trees at each time step.</p></li>
<li><p><code>shrub_table</code>: A list of data frames for each simulated stand, containing the living shrub at each time step.</p></li>
<li><p><code>dead_tree_table</code>: A list of data frames for each simulated stand, containing the dead trees at each time step.</p></li>
<li><p><code>dead_shrub_table</code>: A list of data frames for each simulated stand, containing the dead shrub at each time step.</p></li>
<li><p><code>cut_tree_table</code>: A list of data frames for each simulated stand, containing the cut trees at each time step.</p></li>
<li><p><code>cut_shrub_table</code>: A list of data frames for each simulated stand, containing the cut shrub at each time step.</p></li>
</ul></li>
<li><p><code>watershed_balance</code>: A data frame with as many rows as summary points and where columns are components of the water balance at the watershed level (i.e., rain, snow, interception, infiltration, soil evaporation, plant transpiration, ...).</p></li>
<li><p><code>watershed_soil_balance</code>: A data frame with as many rows as summary points and where columns are components of the water balance at the watershed level restricted to those cells with a soil definition.</p></li>
<li><p><code>daily_runoff</code>: A matrix with daily runoff (in m3/day) at each of the outlet cells of the landscape.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    
<ul><li><p>Function <code>spwb_land</code> implements a distributed hydrological model that simulates daily local water balance, from <code>spwb_day</code>,
on grid cells of a watershed while accounting for overland runoff, subsurface flow and groundwater flow between cells.</p></li>
<li><p>Function <code>growth_land</code> is similar to <code>spwb_land</code>, but includes daily local carbon balance, growth and mortality processes in grid cells,
provided by <code>growth_day</code>.</p></li>
<li><p>Function <code>fordyn_land</code> extends the previous two functions with the simulation of management, recruitment
and resprouting.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>spwb_day</code>,  <code>growth_day</code>,
<code><a href="spwb_spatial.html">spwb_spatial</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CREAF.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Load example watershed data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_watershed"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set crop factor </span></span></span>
<span class="r-in"><span><span class="va">example_watershed</span><span class="op">$</span><span class="va">crop_factor</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">example_watershed</span><span class="op">$</span><span class="va">crop_factor</span><span class="op">[</span><span class="va">example_watershed</span><span class="op">$</span><span class="va">land_cover_type</span><span class="op">==</span><span class="st">"agriculture"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.75</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load example meteo data frame from package meteoland</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"examplemeteo"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># Load default medfate parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SpParamsMED"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># Set simulation period</span></span></span>
<span class="r-in"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-03-31"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Launch simulations</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">spwb_land</span><span class="op">(</span><span class="va">example_watershed</span>, <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, </span></span>
<span class="r-in"><span>                 dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miquel De Cáceres, Aitor Améztegui, María González.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

