<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watershed simulations • medfateland</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Watershed simulations">
<meta property="og:description" content="medfateland">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfateland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Watershed simulations</h1>
                        <h4 data-toc-skip class="author">Miquel De
Caceres</h4>
            
            <h4 data-toc-skip class="date">2024-02-03</h4>
      
      
      <div class="hidden name"><code>WatershedSimulations.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="aim">Aim<a class="anchor" aria-label="anchor" href="#aim"></a>
</h2>
<p>The aim of this vignette is to illustrate how to use
<strong>medfateland</strong> (v. 2.1.0) to carry out simulations of
forest function and dynamics on a set of forest stands while including
lateral water transfer processes. This is done using functions
<code><a href="../reference/spwb_land.html">spwb_land()</a></code>, <code><a href="../reference/spwb_land.html">growth_land()</a></code> and
<code><a href="../reference/spwb_land.html">fordyn_land()</a></code>; which are counterparts of functions
<code>spwb()</code>, <code>growth()</code> and <code>fordyn()</code> in
package <strong>medfate</strong>. As an example, we will use function
<code><a href="../reference/spwb_land.html">spwb_land()</a></code>, but the other two functions would be used
similarly.</p>
</div>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<p>Preparing inputs for watershed simulations can be tedious. Two main
inputs need to be assembled, described in the following two
sections.</p>
<div class="section level3">
<h3 id="input-sf-objects">Input sf objects<a class="anchor" aria-label="anchor" href="#input-sf-objects"></a>
</h3>
<p>Here we load a small example watershed included with the package,
that can be used to understand the inputs required:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_watershed"</span><span class="op">)</span></span>
<span><span class="va">example_watershed</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 66 features and 14 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 401430 ymin: 4671870 xmax: 402830 ymax: 4672570</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 31N</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 66 × 15</span></span></span>
<span><span class="co">##            geometry    id elevation slope aspect land_cover_type</span></span>
<span><span class="co">##  <span style="color: #BCBCBC;">*</span>      <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (402630 4672570)     1      <span style="text-decoration: underline;">1</span>162 11.3   79.2  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (402330 4672470)     2      <span style="text-decoration: underline;">1</span>214 12.4   98.7  agriculture    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (402430 4672470)     3      <span style="text-decoration: underline;">1</span>197 10.4  102.   wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (402530 4672470)     4      <span style="text-decoration: underline;">1</span>180  8.12  83.3  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> (402630 4672470)     5      <span style="text-decoration: underline;">1</span>164 13.9   96.8  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (402730 4672470)     6      <span style="text-decoration: underline;">1</span>146 11.2    8.47 agriculture    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (402830 4672470)     7      <span style="text-decoration: underline;">1</span>153  9.26 356.   agriculture    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (402230 4672370)     8      <span style="text-decoration: underline;">1</span>237 14.5   75.1  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (402330 4672370)     9      <span style="text-decoration: underline;">1</span>213 13.2   78.7  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (402430 4672370)    10      <span style="text-decoration: underline;">1</span>198  8.56  75.6  agriculture    </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 56 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9 more variables: forest &lt;list&gt;, soil &lt;list&gt;, state &lt;list&gt;, channel &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   depth_to_bedrock &lt;dbl&gt;, bedrock_conductivity &lt;dbl&gt;, bedrock_porosity &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   snowpack &lt;dbl&gt;, aquifer &lt;dbl&gt;</span></span></span></code></pre>
<p>Some of the columns like <code>forest</code>, <code>soil</code>,
<code>elevation</code>, or <code>state</code>, were also present in the
example for spatially-uncoupled simulations, so we will not repeat them.
The following describes additional columns that are relevant here.</p>
<p><strong>Land cover type</strong></p>
<p>Simulations over watersheds normally include different land cover
types. These are described in column <code>land_cover_type</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">example_watershed</span><span class="op">$</span><span class="va">land_cover_type</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## agriculture        rock    wildland </span></span>
<span><span class="co">##          17           1          48</span></span></code></pre>
<p>Local and landscape processes will behave differently depending on
the land cover type.</p>
<p><strong>Aquifer and snowpack</strong></p>
<p>Columns <code>aquifer</code> and <code>snowpack</code> are used as
state variables to store the water content in the aquifer and snowpack,
respectively.</p>
<p><strong>Crop factors</strong></p>
<p>Since the landscape contains agricultural lands, we need to define
<em>crop factors</em>, which will determine transpiration flow as a
proportion of potential evapotranspiration:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_watershed</span><span class="op">$</span><span class="va">crop_factor</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="va">example_watershed</span><span class="op">$</span><span class="va">crop_factor</span><span class="op">[</span><span class="va">example_watershed</span><span class="op">$</span><span class="va">land_cover_type</span><span class="op">==</span><span class="st">"agriculture"</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.75</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="grid-topology">Grid topology<a class="anchor" aria-label="anchor" href="#grid-topology"></a>
</h3>
<p>Note that the <code>sf</code> structure does not imply a grid <em>per
se</em>. Point geometry is used to describe the central coordinates of
grid cells, but does not describe the grid. This means that another
spatial input is needed to describe the grid topology, which in our case
is an object of class <code>SpatRaster</code> from package
<strong>terra</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">401380</span>, ymin <span class="op">=</span> <span class="fl">4671820</span>, xmax <span class="op">=</span> <span class="fl">402880</span>, ymax <span class="op">=</span> <span class="fl">4672620</span>, </span>
<span>                nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">15</span>, crs <span class="op">=</span> <span class="st">"epsg:32631"</span><span class="op">)</span></span>
<span><span class="va">r</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 8, 15, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 100, 100  (x, y)</span></span>
<span><span class="co">## extent      : 401380, 402880, 4671820, 4672620  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : WGS 84 / UTM zone 31N (EPSG:32631)</span></span></code></pre>
<p>The <code>r</code> object must have the same coordinate reference
system as the <code>sf</code> object. Moreover, each grid cell can
contain up to one point of the <code>sf</code> (typically at the cell
center). Some grid cells may be empty, though, so that the actual
simulations may be done on an incomplete grid. Note that the raster does
not contain data, only the topology is needed (to define neighbors and
cell sizes, for example). All relevant attribute data is already
included in the <code>sf</code> object.</p>
</div>
<div class="section level3">
<h3 id="watershed-control-options">Watershed control options<a class="anchor" aria-label="anchor" href="#watershed-control-options"></a>
</h3>
<p>Analogously to local-scale simulations with <strong>medfate</strong>,
watershed simulations have overall control parameters. Notably, the user
needs to decide which sub-model will be used for lateral water transfer
processes (a decision similar to choosing the plant transpiration
sub-model in <strong>medfate</strong>), by default “tetis”:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ws_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/default_watershed_control.html">default_watershed_control</a></span><span class="op">(</span><span class="st">"tetis"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="carrying-out-simulations">Carrying out simulations<a class="anchor" aria-label="anchor" href="#carrying-out-simulations"></a>
</h2>
<div class="section level3">
<h3 id="launching-watershed-simulations">Launching watershed simulations<a class="anchor" aria-label="anchor" href="#launching-watershed-simulations"></a>
</h3>
<p>To speed up calculations, we call function <code><a href="../reference/spwb_land.html">spwb_land()</a></code>
for a single month:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-31"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">res_ws1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Simulation of model 'spwb' over a watershed</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking topology</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking topology <span style="color: #B2B2B2;">[12ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking 'sf' data</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking 'sf' data <span style="color: #B2B2B2;">[23ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Determining neighbors and discharge for TETIS</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Determining neighbors and discharge for TETIS <span style="color: #B2B2B2;">[32ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## • Hydrological model: TETIS</span></span></code></pre>
<pre><code><span><span class="co">## • Number of grid cells: 120 Number of target cells: 66</span></span></code></pre>
<pre><code><span><span class="co">## • Average cell area: 10006 m2, Total area: 120 ha, Target area: 66 ha</span></span></code></pre>
<pre><code><span><span class="co">## • Cell land use wildland: 48 agriculture: 17 artificial: 0 rock: 1 water: 0</span></span></code></pre>
<pre><code><span><span class="co">## • Cells with soil: 65</span></span></code></pre>
<pre><code><span><span class="co">## • Number of days to simulate: 31</span></span></code></pre>
<pre><code><span><span class="co">## • Number of temporal summaries: 1</span></span></code></pre>
<pre><code><span><span class="co">## • Number of cells with daily model results requested: 0</span></span></code></pre>
<pre><code><span><span class="co">## • Number of outlet cells: 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Building spwb input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Building spwb input <span style="color: #B2B2B2;">[500ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> 65 cells needed initialization</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> 65 cells needed initialization <span style="color: #B2B2B2;">[12ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## Daily simulations <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  68% | ETA:  1s</span></span></code></pre>
<pre><code><span><span class="co">## Daily simulations <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span></code></pre>
<pre><code><span><span class="co">## • Done</span></span></code></pre>
<pre><code><span><span class="co">## • Water balance check</span></span></code></pre>
<pre><code><span><span class="co">##   Change in snowpack water content (mm): 3.34</span></span>
<span><span class="co">##   Snowpack water balance result (mm): 3.34</span></span>
<span><span class="co">##   Snowpack water balance components:</span></span>
<span><span class="co">##     Snow fall (mm) 16.65 Snow melt (mm) 13.31</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Change in soil water content (mm): -3.91</span></span>
<span><span class="co">##   Soil water balance result (mm): 2.49</span></span>
<span><span class="co">##   Soil water balance components:</span></span>
<span><span class="co">##     Infiltration (mm) 63.69</span></span>
<span><span class="co">##     Subsurface input (mm) 0  Subsurface output (mm) 0</span></span>
<span><span class="co">##     Deep drainage (mm) 52.46 Aquifer discharge (mm) 0</span></span>
<span><span class="co">##     Soil evaporation (mm) 5.06 Plant transpiration (mm) 3.68</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Change in aquifer water content (mm): 51.67</span></span>
<span><span class="co">##   Aquifer water balance result (mm): 51.67</span></span>
<span><span class="co">##   Aquifer water balance components:</span></span>
<span><span class="co">##     Deep drainage (mm) 51.67 Aquifer discharge (mm) 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Change in watershed water content (mm): 51.16</span></span>
<span><span class="co">##   Watershed water balance result (mm): 42.49</span></span>
<span><span class="co">##   Watershed water balance components:</span></span>
<span><span class="co">##     Precipitation (mm) 74.75</span></span>
<span><span class="co">##     Interception (mm) 23.66 Soil evaporation (mm) 4.98 Plant Transpiration (mm) 3.62</span></span>
<span><span class="co">##     Export (mm) 0</span></span>
<span><span class="co">##   Watershed lateral flows:</span></span>
<span><span class="co">##     Subsurface flow (mm) 0</span></span>
<span><span class="co">##     Groundwater flow (mm) 11.11</span></span></code></pre>
<p>Although simulations are performed using daily temporal steps,
parameter <code>summary_frequency</code> allows storing results at
coarser temporal scales, to reduce the amount of memory in spatial
results.</p>
</div>
<div class="section level3">
<h3 id="structure-of-simulation-outputs">Structure of simulation outputs<a class="anchor" aria-label="anchor" href="#structure-of-simulation-outputs"></a>
</h3>
<p>Function <code><a href="../reference/spwb_land.html">spwb_land()</a></code> and <code><a href="../reference/spwb_land.html">growth_land()</a></code>
return a list with the following elements:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_ws1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sf"                     "watershed_balance"      "watershed_soil_balance"</span></span>
<span><span class="co">## [4] "daily_runoff"</span></span></code></pre>
<p>Where <code>sf</code> is an object of class <code>sf</code>,
analogous to those of functions <code>*_spatial()</code>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 66 features and 5 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 401430 ymin: 4671870 xmax: 402830 ymax: 4672570</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 31N</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 66 × 6</span></span></span>
<span><span class="co">##            geometry state           aquifer snowpack summary        result</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (402630 4672570) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span>    45.2     3.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (402330 4672470) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>     52.5     3.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (402430 4672470) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span>    37.3     3.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (402530 4672470) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span>    64.0     2.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> (402630 4672470) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span>    65.2     2.57 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (402730 4672470) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>     56.7     3.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (402830 4672470) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>     54.8     3.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (402230 4672370) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span>    60.8     2.84 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (402330 4672370) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span>    60.2     2.97 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (402430 4672370) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>     54.1     3.56 <span style="color: #949494;">&lt;dbl [1 × 25]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre>
<p>Columns <code>state</code>, <code>aquifer</code> and
<code>snowpack</code> contain state variables, whereas
<code>summary</code> contains temporal water balance summaries for all
cells. Column <code>result</code> is empty in this case, but see
below.</p>
<p>The other elements of the simulation result list
(<code>watershed_balance</code>, <code>watershed_soil_balance</code> and
<code>daily_runoff</code>) refer to watershed level results.</p>
</div>
<div class="section level3">
<h3 id="accessing-and-plotting-cell-summaries">Accessing and plotting cell summaries<a class="anchor" aria-label="anchor" href="#accessing-and-plotting-cell-summaries"></a>
</h3>
<p>Unlike <code><a href="../reference/spwb_spatial.html">spwb_spatial()</a></code> where summaries could be
arbitrarily generated <em>a posteriori</em> from simulation results,
with <code><a href="../reference/spwb_land.html">spwb_land()</a></code> the summaries are always fixed and
embedded with the simulation result. For example, we can inspect the
summaries for a given landscape cell using:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            MinTemperature MaxTemperature      PET Runon Runoff Infiltration</span></span>
<span><span class="co">## 2001-01-01      -3.203556       2.427977 31.14151     0      0     54.01675</span></span>
<span><span class="co">##                Rain  NetRain     Snow Snowmelt Interception DeepDrainage</span></span>
<span><span class="co">## 2001-01-01 58.09884 40.92374 16.65065 13.09301      17.1751     44.71801</span></span>
<span><span class="co">##            AquiferDischarge SaturationExcess SoilEvaporation Transpiration</span></span>
<span><span class="co">## 2001-01-01                0                0        5.275463      6.739765</span></span>
<span><span class="co">##                 SWE  SoilVol        Psi1  WTD      DTA InterflowInput</span></span>
<span><span class="co">## 2001-01-01 1.649861 531.3573 -0.03468164 4000 14.99564              0</span></span>
<span><span class="co">##            InterflowOutput BaseflowInput BaseflowOutput</span></span>
<span><span class="co">## 2001-01-01               0      6.908747       1.781939</span></span></code></pre>
<p>Several plots can be drawn from the result of function
<code><a href="../reference/spwb_land.html">spwb_land()</a></code> in a similar way as done for
<code><a href="../reference/spwb_spatial.html">spwb_spatial()</a></code>. As an example we display a map of soil
water volume for the simulated month:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_summary.html">plot_summary</a></span><span class="op">(</span><span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span>, <span class="st">"SoilVol"</span>, <span class="st">"2001-01-01"</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="full-simulation-results-for-specific-cells">Full simulation results for specific cells<a class="anchor" aria-label="anchor" href="#full-simulation-results-for-specific-cells"></a>
</h3>
<p>The idea of generating summaries arises from the fact that local
models can produce a large amount of results, of which only some are of
interest at the landscape level. Nevertheless, it is possible to specify
those cells for which full daily results are desired. This is done by
adding a column <code>result_cell</code> in the input <code>sf</code>
object:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set request for daily model results in cells number 3 and 9</span></span>
<span><span class="va">example_watershed</span><span class="op">$</span><span class="va">result_cell</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">example_watershed</span><span class="op">$</span><span class="va">result_cell</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>If we launch the simulations again (omitting progress
information):</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We can now retrieve the results of the desired cell, e.g. the third
one, in column <code>result</code> of <code>sf</code>:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">result</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "spwb" "list"</span></span></code></pre>
<p>This object has class <code>spwb</code> and the same structure
returned by function <code>spwb()</code> of <strong>medfate</strong>.
Hence, we can inspect daily results using functions
<code>shinyplot()</code> or <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, for example:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="continuing-a-previous-simulation">Continuing a previous simulation<a class="anchor" aria-label="anchor" href="#continuing-a-previous-simulation"></a>
</h3>
<p>The result of a simulation includes an element <code>state</code>,
which stores the state of soil and stand variables at the end of the
simulation. This information can be used to perform a new simulation
from the point where the first one ended. In order to do so, we need to
update the state variables in spatial object with their values at the
end of the simulation, using function
<code><a href="../reference/update_landscape.html">update_landscape()</a></code>:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_watershed_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_landscape.html">update_landscape</a></span><span class="op">(</span><span class="va">example_watershed</span>, <span class="va">res_ws1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_watershed_mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "geometry"             "id"                   "elevation"           </span></span>
<span><span class="co">##  [4] "slope"                "aspect"               "land_cover_type"     </span></span>
<span><span class="co">##  [7] "forest"               "soil"                 "state"               </span></span>
<span><span class="co">## [10] "channel"              "depth_to_bedrock"     "bedrock_conductivity"</span></span>
<span><span class="co">## [13] "bedrock_porosity"     "snowpack"             "aquifer"             </span></span>
<span><span class="co">## [16] "crop_factor"          "result_cell"</span></span></code></pre>
<p>Note that a new column <code>state</code> appears in now in the
<strong>sf</strong> object. We can check the effect by drawing the water
potential in the first soil layer:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_variables.html">plot_variable</a></span><span class="op">(</span><span class="va">example_watershed_mod</span>, <span class="st">"psi1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now we can continue our simulation, in this case adding an extra
month:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-02-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-02-28"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">res_ws3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed_mod</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Simulation of model 'spwb' over a watershed</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking topology</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking topology <span style="color: #B2B2B2;">[9ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking 'sf' data</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking 'sf' data <span style="color: #B2B2B2;">[143ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Determining neighbors and discharge for TETIS</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Determining neighbors and discharge for TETIS <span style="color: #B2B2B2;">[12ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## • Hydrological model: TETIS</span></span></code></pre>
<pre><code><span><span class="co">## • Number of grid cells: 120 Number of target cells: 66</span></span></code></pre>
<pre><code><span><span class="co">## • Average cell area: 10006 m2, Total area: 120 ha, Target area: 66 ha</span></span></code></pre>
<pre><code><span><span class="co">## • Cell land use wildland: 48 agriculture: 17 artificial: 0 rock: 1 water: 0</span></span></code></pre>
<pre><code><span><span class="co">## • Cells with soil: 65</span></span></code></pre>
<pre><code><span><span class="co">## • Number of days to simulate: 28</span></span></code></pre>
<pre><code><span><span class="co">## • Number of temporal summaries: 1</span></span></code></pre>
<pre><code><span><span class="co">## • Number of cells with daily model results requested: 2</span></span></code></pre>
<pre><code><span><span class="co">## • Number of outlet cells: 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Building spwb input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Building spwb input <span style="color: #B2B2B2;">[4ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> 0 cells needed initialization</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> 0 cells needed initialization <span style="color: #B2B2B2;">[13ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## Daily simulations <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■           </span>  68% | ETA:  1s</span></span></code></pre>
<pre><code><span><span class="co">## Daily simulations <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span></code></pre>
<pre><code><span><span class="co">## • Done</span></span></code></pre>
<pre><code><span><span class="co">## • Water balance check</span></span></code></pre>
<pre><code><span><span class="co">##   Change in snowpack water content (mm): -2.79</span></span>
<span><span class="co">##   Snowpack water balance result (mm): -2.79</span></span>
<span><span class="co">##   Snowpack water balance components:</span></span>
<span><span class="co">##     Snow fall (mm) 2.54 Snow melt (mm) 5.33</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Change in soil water content (mm): -16.56</span></span>
<span><span class="co">##   Soil water balance result (mm): -4.19</span></span>
<span><span class="co">##   Soil water balance components:</span></span>
<span><span class="co">##     Infiltration (mm) 7.17</span></span>
<span><span class="co">##     Subsurface input (mm) 0  Subsurface output (mm) 0</span></span>
<span><span class="co">##     Deep drainage (mm) 2.31 Aquifer discharge (mm) 0</span></span>
<span><span class="co">##     Soil evaporation (mm) 1.64 Plant transpiration (mm) 7.41</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Change in aquifer water content (mm): 2.28</span></span>
<span><span class="co">##   Aquifer water balance result (mm): 2.28</span></span>
<span><span class="co">##   Aquifer water balance components:</span></span>
<span><span class="co">##     Deep drainage (mm) 2.28 Aquifer discharge (mm) 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Change in watershed water content (mm): -16.82</span></span>
<span><span class="co">##   Watershed water balance result (mm): -5.27</span></span>
<span><span class="co">##   Watershed water balance components:</span></span>
<span><span class="co">##     Precipitation (mm) 5</span></span>
<span><span class="co">##     Interception (mm) 1.36 Soil evaporation (mm) 1.61 Plant Transpiration (mm) 7.3</span></span>
<span><span class="co">##     Export (mm) 0</span></span>
<span><span class="co">##   Watershed lateral flows:</span></span>
<span><span class="co">##     Subsurface flow (mm) 0</span></span>
<span><span class="co">##     Groundwater flow (mm) 23.47</span></span></code></pre>
<p>The fact that no cell required initialization is an indication that
we used an already initialized landscape.</p>
</div>
<div class="section level3">
<h3 id="simulations-of-watershed-forest-dynamics">Simulations of watershed forest dynamics<a class="anchor" aria-label="anchor" href="#simulations-of-watershed-forest-dynamics"></a>
</h3>
<p>Running <code><a href="../reference/spwb_land.html">growth_land()</a></code> is very similar to running
<code><a href="../reference/spwb_land.html">spwb_land()</a></code>. However, a few things change when we want to
simulate forest dynamics using <code><a href="../reference/spwb_land.html">fordyn_land()</a></code>. Regarding the
<code>sf</code> input, an additional column
<code>management_arguments</code> may be defined to specify the forest
management arguments (i.e. silviculture) of cells. Furthermore, the
function does not allow choosing the temporal scale of summaries. A call
to <code><a href="../reference/spwb_land.html">fordyn_land()</a></code> for a single year is given here (we subset
the input to speed-up calculations):</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">fordyn_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>,</span>
<span>                       <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>,</span>
<span>                       watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Simulation of model 'fordyn' over a watershed</span> <span style="color: #00BBBB;">───────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking topology</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking topology <span style="color: #B2B2B2;">[10ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking 'sf' data</span></span></code></pre>
<pre><code><span><span class="co">## • Hydrological model: TETIS</span></span></code></pre>
<pre><code>##  [36mℹ [39m Checking 'sf' data
• Number of grid cells: 120 Number of target cells: 10
##  [36mℹ [39m Checking 'sf' data
• Average cell area: 10006 m2, Total area: 120 ha, Target area: 10 ha
##  [36mℹ [39m Checking 'sf' data
• Cell land use wildland: 6 agriculture: 4 artificial: 0 rock: 0 water: 0
##  [36mℹ [39m Checking 'sf' data
• Cells with soil: 10
##  [36mℹ [39m Checking 'sf' data
• Number of years to simulate: 1
##  [36mℹ [39m Checking 'sf' data
##  [36mℹ [39m Checking 'sf' data
── Initialisation 
##  [36mℹ [39m Checking 'sf' data
 [36mℹ [39m Creating 10 input objects for model 'growth'.
##  [32m✔ [39m Creating 10 input objects for model 'growth'.  [38;5;249m[4ms] [39m
## 
##  [36mℹ [39m Checking 'sf' data
 [32m✔ [39m Checking 'sf' data  [38;5;249m[199ms] [39m
## 
##  [36mℹ [39m Initializing 'fordyn' output tables
##  [32m✔ [39m Initializing 'fordyn' output tables  [38;5;249m[19ms] [39m
## 
## 
## ── Simulating year 2001 [1/1] 
## • Growth/mortality
## Daily simulations  [32m■■■■                             [39m   9% | ETA: 12s
## Daily simulations  [32m■■■■■■■■■■                       [39m  30% | ETA: 10s
## Daily simulations  [32m■■■■■■■■■■■■■■■■                 [39m  51% | ETA:  7s
## Daily simulations  [32m■■■■■■■■■■■■■■■■■■■■■■■          [39m  73% | ETA:  4s
## Daily simulations  [32m■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    [39m  94% | ETA:  1s
## Daily simulations  [32m■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  [39m 100% | ETA:  0s
## • Seed production/dispersal
## • Management/recruitment/resprouting</code></pre>
<p>In this case, the <code>sf</code> part of the output contains
additional columns, analogous to those of
<code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code>.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_ws2</span><span class="op">$</span><span class="va">sf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "geometry"         "state"            "aquifer"          "snowpack"        </span></span>
<span><span class="co">##  [5] "summary"          "forest"           "tree_table"       "shrub_table"     </span></span>
<span><span class="co">##  [9] "dead_tree_table"  "dead_shrub_table" "cut_tree_table"   "cut_shrub_table"</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miquel De Cáceres, Aitor Améztegui, María González, Daniel Caviedes-Voullième, Mario Morales-Hernández.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
