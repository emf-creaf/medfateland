<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watershed simulations • medfateland</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Watershed simulations">
<meta property="og:description" content="medfateland">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfateland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Watershed simulations</h1>
                        <h4 data-toc-skip class="author">Miquel De
Caceres</h4>
            
            <h4 data-toc-skip class="date">2024-04-20</h4>
      
      
      <div class="hidden name"><code>WatershedSimulations.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="aim">Aim<a class="anchor" aria-label="anchor" href="#aim"></a>
</h2>
<p>The aim of this vignette is to illustrate how to use
<strong>medfateland</strong> (v. 2.2.1) to carry out simulations of
forest function and dynamics on a set of forest stands while including
lateral water transfer processes. This is done using functions
<code><a href="../reference/spwb_land.html">spwb_land()</a></code>, <code><a href="../reference/spwb_land.html">growth_land()</a></code> and
<code><a href="../reference/spwb_land.html">fordyn_land()</a></code>; which are counterparts of functions
<code>spwb()</code>, <code>growth()</code> and <code>fordyn()</code> in
package <strong>medfate</strong>. As an example, we will use function
<code><a href="../reference/spwb_land.html">spwb_land()</a></code>, but the other two functions would be used
similarly.</p>
</div>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<p>Preparing inputs for watershed simulations can be tedious. Two main
inputs need to be assembled, described in the following two
sections.</p>
<div class="section level3">
<h3 id="input-sf-objects">Input sf objects<a class="anchor" aria-label="anchor" href="#input-sf-objects"></a>
</h3>
<p>Here we load a small example watershed included with the package,
that can be used to understand the inputs required:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_watershed"</span><span class="op">)</span></span>
<span><span class="va">example_watershed</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 66 features and 13 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 401430 ymin: 4671870 xmax: 402830 ymax: 4672570</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 31N</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 66 × 14</span></span></span>
<span><span class="co">##            geometry    id elevation slope aspect land_cover_type</span></span>
<span><span class="co">##  <span style="color: #BCBCBC;">*</span>      <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (402630 4672570)     1      <span style="text-decoration: underline;">1</span>162 11.3   79.2  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (402330 4672470)     2      <span style="text-decoration: underline;">1</span>214 12.4   98.7  agriculture    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (402430 4672470)     3      <span style="text-decoration: underline;">1</span>197 10.4  102.   wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (402530 4672470)     4      <span style="text-decoration: underline;">1</span>180  8.12  83.3  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> (402630 4672470)     5      <span style="text-decoration: underline;">1</span>164 13.9   96.8  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (402730 4672470)     6      <span style="text-decoration: underline;">1</span>146 11.2    8.47 agriculture    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (402830 4672470)     7      <span style="text-decoration: underline;">1</span>153  9.26 356.   agriculture    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (402230 4672370)     8      <span style="text-decoration: underline;">1</span>237 14.5   75.1  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (402330 4672370)     9      <span style="text-decoration: underline;">1</span>213 13.2   78.7  wildland       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (402430 4672370)    10      <span style="text-decoration: underline;">1</span>198  8.56  75.6  agriculture    </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 56 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 8 more variables: forest &lt;list&gt;, soil &lt;list&gt;, state &lt;list&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   depth_to_bedrock &lt;dbl&gt;, bedrock_conductivity &lt;dbl&gt;, bedrock_porosity &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   snowpack &lt;dbl&gt;, aquifer &lt;dbl&gt;</span></span></span></code></pre>
<p>Some of the columns like <code>forest</code>, <code>soil</code>,
<code>elevation</code>, or <code>state</code>, were also present in the
example for spatially-uncoupled simulations, so we will not repeat them.
The following describes additional columns that are relevant here.</p>
<p><strong>Land cover type</strong></p>
<p>Simulations over watersheds normally include different land cover
types. These are described in column <code>land_cover_type</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">example_watershed</span><span class="op">$</span><span class="va">land_cover_type</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## agriculture        rock    wildland </span></span>
<span><span class="co">##          17           1          48</span></span></code></pre>
<p>Local and landscape processes will behave differently depending on
the land cover type.</p>
<p><strong>Aquifer and snowpack</strong></p>
<p>Columns <code>aquifer</code> and <code>snowpack</code> are used as
state variables to store the water content in the aquifer and snowpack,
respectively.</p>
<p><strong>Crop factors</strong></p>
<p>Since the landscape contains agricultural lands, we need to define
<em>crop factors</em>, which will determine transpiration flow as a
proportion of potential evapotranspiration:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_watershed</span><span class="op">$</span><span class="va">crop_factor</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="va">example_watershed</span><span class="op">$</span><span class="va">crop_factor</span><span class="op">[</span><span class="va">example_watershed</span><span class="op">$</span><span class="va">land_cover_type</span><span class="op">==</span><span class="st">"agriculture"</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.75</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="grid-topology">Grid topology<a class="anchor" aria-label="anchor" href="#grid-topology"></a>
</h3>
<p>Note that the <code>sf</code> structure does not imply a grid <em>per
se</em>. Point geometry is used to describe the central coordinates of
grid cells, but does not describe the grid. This means that another
spatial input is needed to describe the grid topology, which in our case
is an object of class <code>SpatRaster</code> from package
<strong>terra</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">401380</span>, ymin <span class="op">=</span> <span class="fl">4671820</span>, xmax <span class="op">=</span> <span class="fl">402880</span>, ymax <span class="op">=</span> <span class="fl">4672620</span>, </span>
<span>                nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">15</span>, crs <span class="op">=</span> <span class="st">"epsg:32631"</span><span class="op">)</span></span>
<span><span class="va">r</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 8, 15, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 100, 100  (x, y)</span></span>
<span><span class="co">## extent      : 401380, 402880, 4671820, 4672620  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : WGS 84 / UTM zone 31N (EPSG:32631)</span></span></code></pre>
<p>The <code>r</code> object must have the same coordinate reference
system as the <code>sf</code> object. Moreover, each grid cell can
contain up to one point of the <code>sf</code> (typically at the cell
center). Some grid cells may be empty, though, so that the actual
simulations may be done on an incomplete grid. Note that the raster does
not contain data, only the topology is needed (to define neighbors and
cell sizes, for example). All relevant attribute data is already
included in the <code>sf</code> object.</p>
<p>Combining the <code>r</code> and <code>sf</code> objects allows
drawing rasterized maps:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_variables.html">plot_variable</a></span><span class="op">(</span><span class="va">example_watershed</span>, variable <span class="op">=</span> <span class="st">"elevation"</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="watershed-control-options">Watershed control options<a class="anchor" aria-label="anchor" href="#watershed-control-options"></a>
</h3>
<p>Analogously to local-scale simulations with <strong>medfate</strong>,
watershed simulations have overall control parameters. Notably, the user
needs to decide which sub-model will be used for lateral water transfer
processes (a decision similar to choosing the plant transpiration
sub-model in <strong>medfate</strong>), by default “tetis”:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ws_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/default_watershed_control.html">default_watershed_control</a></span><span class="op">(</span><span class="st">"tetis"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="carrying-out-simulations">Carrying out simulations<a class="anchor" aria-label="anchor" href="#carrying-out-simulations"></a>
</h2>
<div class="section level3">
<h3 id="launching-watershed-simulations">Launching watershed simulations<a class="anchor" aria-label="anchor" href="#launching-watershed-simulations"></a>
</h3>
<p>To speed up calculations, we call function <code><a href="../reference/spwb_land.html">spwb_land()</a></code>
for a single month:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-31"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">res_ws1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Although simulations are performed using daily temporal steps,
parameter <code>summary_frequency</code> allows storing results at
coarser temporal scales, to reduce the amount of memory in spatial
results.</p>
</div>
<div class="section level3">
<h3 id="structure-of-simulation-outputs">Structure of simulation outputs<a class="anchor" aria-label="anchor" href="#structure-of-simulation-outputs"></a>
</h3>
<p>Function <code><a href="../reference/spwb_land.html">spwb_land()</a></code> and <code><a href="../reference/spwb_land.html">growth_land()</a></code>
return a list with the following elements:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_ws1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "sf"                     "watershed_balance"      "watershed_soil_balance"</span></span>
<span><span class="co">## [4] "outlet_export_m3s"</span></span></code></pre>
<p>Where <code>sf</code> is an object of class <code>sf</code>,
analogous to those of functions <code>*_spatial()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 66 features and 6 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 401430 ymin: 4671870 xmax: 402830 ymax: 4672570</span></span>
<span><span class="co">## Projected CRS: WGS 84 / UTM zone 31N</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 66 × 7</span></span></span>
<span><span class="co">##            geometry state           aquifer snowpack summary  result outlet</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;POINT [m]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (402630 4672570) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span> 0.040<span style="text-decoration: underline;">4</span>      3.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (402330 4672470) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>  0.198       3.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (402430 4672470) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span> 0.056<span style="text-decoration: underline;">6</span>      3.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (402530 4672470) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span> 0.048<span style="text-decoration: underline;">2</span>      2.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> (402630 4672470) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span> 0.009<span style="text-decoration: underline;">94</span>     2.57 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (402730 4672470) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>  0.243       3.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> TRUE  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (402830 4672470) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>  0.165       3.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (402230 4672370) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span> 0.002<span style="text-decoration: underline;">75</span>     2.84 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (402330 4672370) <span style="color: #949494;">&lt;spwbInpt [17]&gt;</span> 0.004<span style="text-decoration: underline;">19</span>     2.97 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (402430 4672370) <span style="color: #949494;">&lt;aspwbInp [3]&gt;</span>  0.239       3.56 <span style="color: #949494;">&lt;dbl[…]&gt;</span> <span style="color: #949494;">&lt;NULL&gt;</span> FALSE </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre>
<p>Columns <code>state</code>, <code>aquifer</code> and
<code>snowpack</code> contain state variables, whereas
<code>summary</code> contains temporal water balance summaries for all
cells. Column <code>result</code> is empty in this case, but see
below.</p>
<p>The next two elements of the simulation result list, namely
<code>watershed_balance</code> and <code>watershed_soil_balance</code>,
refer to watershed-level results. For example,
<code>watershed_balance</code> contains the daily elements of the water
balance at the watershed level, including the amount of water exported
in mm in the last column.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_ws1</span><span class="op">$</span><span class="va">watershed_balance</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        dates Precipitation      Rain Snow Snowmelt Interception   NetRain</span></span>
<span><span class="co">## 1 2001-01-01      4.869109  4.869109    0        0    0.7900101  4.079099</span></span>
<span><span class="co">## 2 2001-01-02      2.498292  2.498292    0        0    0.6919287  1.806363</span></span>
<span><span class="co">## 3 2001-01-03      0.000000  0.000000    0        0    0.0000000  0.000000</span></span>
<span><span class="co">## 4 2001-01-04      5.796973  5.796973    0        0    0.7855456  5.011427</span></span>
<span><span class="co">## 5 2001-01-05      1.884401  1.884401    0        0    0.5571451  1.327256</span></span>
<span><span class="co">## 6 2001-01-06     13.359801 13.359801    0        0    0.8937189 12.466082</span></span>
<span><span class="co">##   Infiltration InfiltrationExcess SaturationExcess     Runoff DeepDrainage</span></span>
<span><span class="co">## 1     4.005324                  0                0 0.07377438  0.003545635</span></span>
<span><span class="co">## 2     1.768510                  0                0 0.03785290  0.003504170</span></span>
<span><span class="co">## 3     0.000000                  0                0 0.00000000  0.003465461</span></span>
<span><span class="co">## 4     4.923594                  0                0 0.08783292  0.003787363</span></span>
<span><span class="co">## 5     1.298705                  0                0 0.02855154  0.003944415</span></span>
<span><span class="co">## 6    12.263661                  0                0 0.20242122  0.004965145</span></span>
<span><span class="co">##   CapillarityRise SoilEvaporation Transpiration HerbTranspiration</span></span>
<span><span class="co">## 1    2.247422e-05       0.3867130     0.2793608                 0</span></span>
<span><span class="co">## 2    1.757712e-04       0.1356762     0.4955779                 0</span></span>
<span><span class="co">## 3    5.613658e-04       0.1844224     0.4164836                 0</span></span>
<span><span class="co">## 4    2.330954e-05       0.1257523     0.1874572                 0</span></span>
<span><span class="co">## 5    7.269397e-04       0.1448613     0.5090040                 0</span></span>
<span><span class="co">## 6    4.064161e-04       0.1293526     0.3742005                 0</span></span>
<span><span class="co">##   InterflowBalance BaseflowBalance AquiferExfiltration WatershedExport</span></span>
<span><span class="co">## 1     0.000000e+00    0.000000e+00                   0      0.07377438</span></span>
<span><span class="co">## 2    -1.443806e-23   -1.673341e-31                   0      0.03785290</span></span>
<span><span class="co">## 3    -1.604229e-23   -2.581727e-30                   0      0.00000000</span></span>
<span><span class="co">## 4    -1.411722e-22    9.561950e-30                   0      0.08783292</span></span>
<span><span class="co">## 5    -5.903563e-22    5.507683e-29                   0      0.02855154</span></span>
<span><span class="co">## 6    -6.416916e-22   -1.223930e-29                   0      0.20242122</span></span></code></pre>
<p>Values of this output data frame are averages across cells in the
landscape. Data frame <code>watershed_soil_balance</code> is similar to
<code>watershed_balance</code> but focusing on cells that have a soil
(i.e. excluding artificial, rock or water land cover). Finally,
<code>outlet_export_m3</code> contains the volume reaching each outlet
cell per day:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_ws1</span><span class="op">$</span><span class="va">outlet_export_m3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                       6</span></span>
<span><span class="co">## 2001-01-01 0.0005638724</span></span>
<span><span class="co">## 2001-01-02 0.0002893174</span></span>
<span><span class="co">## 2001-01-03 0.0000000000</span></span>
<span><span class="co">## 2001-01-04 0.0006713247</span></span>
<span><span class="co">## 2001-01-05 0.0002182251</span></span>
<span><span class="co">## 2001-01-06 0.0015471461</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="accessing-and-plotting-cell-summaries">Accessing and plotting cell summaries<a class="anchor" aria-label="anchor" href="#accessing-and-plotting-cell-summaries"></a>
</h3>
<p>Unlike <code><a href="../reference/spwb_spatial.html">spwb_spatial()</a></code> where summaries could be
arbitrarily generated <em>a posteriori</em> from simulation results,
with <code><a href="../reference/spwb_land.html">spwb_land()</a></code> the summaries are always fixed and
embedded with the simulation result. For example, we can inspect the
summaries for a given landscape cell using:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            MinTemperature MaxTemperature      PET     Rain     Snow Snowmelt</span></span>
<span><span class="co">## 2001-01-01      -3.203556       2.427977 31.14151 58.09884 16.65065 13.09301</span></span>
<span><span class="co">##            Interception  NetRain Infiltration InfiltrationExcess</span></span>
<span><span class="co">## 2001-01-01      17.1751 40.92374     54.01675                  0</span></span>
<span><span class="co">##            SaturationExcess Runoff DeepDrainage CapillarityRise SoilEvaporation</span></span>
<span><span class="co">## 2001-01-01                0      0     0.066837      0.02646211        1.693804</span></span>
<span><span class="co">##            Transpiration HerbTranspiration InterflowInput InterflowOutput</span></span>
<span><span class="co">## 2001-01-01      6.765493                 0     0.06753704      0.03424541</span></span>
<span><span class="co">##            InterflowBalance BaseflowInput BaseflowOutput BaseflowBalance</span></span>
<span><span class="co">## 2001-01-01       0.03329163  2.804731e-10    1.50188e-10    1.302852e-10</span></span>
<span><span class="co">##            AquiferExfiltration      SWE  SoilVol        Psi1      WTD     DTA</span></span>
<span><span class="co">## 2001-01-01                   0 1.649861 569.2058 -0.02941237 3625.407 15.4995</span></span></code></pre>
<p>Several plots can be drawn from the result of function
<code><a href="../reference/spwb_land.html">spwb_land()</a></code> in a similar way as done for
<code><a href="../reference/spwb_spatial.html">spwb_spatial()</a></code>. As an example we display a map of the
average water potential of the first soil layer during the simulated
month:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_summary.html">plot_summary</a></span><span class="op">(</span><span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span>, variable <span class="op">=</span> <span class="st">"Psi1"</span>, date <span class="op">=</span> <span class="st">"2001-01-01"</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="full-simulation-results-for-specific-cells">Full simulation results for specific cells<a class="anchor" aria-label="anchor" href="#full-simulation-results-for-specific-cells"></a>
</h3>
<p>The idea of generating summaries arises from the fact that local
models can produce a large amount of results, of which only some are of
interest at the landscape level. Nevertheless, it is possible to specify
those cells for which full daily results are desired. This is done by
adding a column <code>result_cell</code> in the input <code>sf</code>
object:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set request for daily model results in cells number 3 and 9</span></span>
<span><span class="va">example_watershed</span><span class="op">$</span><span class="va">result_cell</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">example_watershed</span><span class="op">$</span><span class="va">result_cell</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>If we launch the simulations again (omitting progress
information):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We can now retrieve the results of the desired cell, e.g. the third
one, in column <code>result</code> of <code>sf</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="va">res_ws1</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">result</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "spwb" "list"</span></span></code></pre>
<p>This object has class <code>spwb</code> and the same structure
returned by function <code>spwb()</code> of <strong>medfate</strong>.
Hence, we can inspect daily results using functions
<code>shinyplot()</code> or <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, for example:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">S</span>, <span class="st">"SoilPsi"</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="continuing-a-previous-simulation">Continuing a previous simulation<a class="anchor" aria-label="anchor" href="#continuing-a-previous-simulation"></a>
</h3>
<p>The result of a simulation includes an element <code>state</code>,
which stores the state of soil and stand variables at the end of the
simulation. This information can be used to perform a new simulation
from the point where the first one ended. In order to do so, we need to
update the state variables in spatial object with their values at the
end of the simulation, using function
<code><a href="../reference/update_landscape.html">update_landscape()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_watershed_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_landscape.html">update_landscape</a></span><span class="op">(</span><span class="va">example_watershed</span>, <span class="va">res_ws1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_watershed_mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "geometry"             "id"                   "elevation"           </span></span>
<span><span class="co">##  [4] "slope"                "aspect"               "land_cover_type"     </span></span>
<span><span class="co">##  [7] "forest"               "soil"                 "state"               </span></span>
<span><span class="co">## [10] "depth_to_bedrock"     "bedrock_conductivity" "bedrock_porosity"    </span></span>
<span><span class="co">## [13] "snowpack"             "aquifer"              "crop_factor"         </span></span>
<span><span class="co">## [16] "result_cell"</span></span></code></pre>
<p>Note that a new column <code>state</code> appears in now in the
<strong>sf</strong> object. We can check the effect by drawing the water
potential in the first soil layer:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_variables.html">plot_variable</a></span><span class="op">(</span><span class="va">example_watershed_mod</span>, variable <span class="op">=</span> <span class="st">"psi1"</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now we can continue our simulation, in this case adding an extra
month:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-02-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-02-28"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">res_ws3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed_mod</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The fact that no cell required initialization is an indication that
we used an already initialized landscape.</p>
</div>
<div class="section level3">
<h3 id="burn-in-periods">Burn-in periods<a class="anchor" aria-label="anchor" href="#burn-in-periods"></a>
</h3>
<p>Like other distributed hydrological models, watershed simulations
with <strong>medfateland</strong> will normally require a burn-in period
to allow soil moisture and aquifer levels to reach a dynamic
equilibrium. We recommend users to use at least one or two years of
burn-in period, but this will depend on the size of the watershed. In
<strong>medfate</strong> we provide users with a copy of the example
watershed, where burn-in period has already been simulated. This can be
seen by inspecting the aquifer level:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_watershed_burnin"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_variables.html">plot_variable</a></span><span class="op">(</span><span class="va">example_watershed_burnin</span>, variable <span class="op">=</span> <span class="st">"aquifer"</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></code></pre></div>
<p><img src="WatershedSimulations_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;"></p>
<p>If we run a one-month simulation on this data set we can then compare
the output before and after the burn-in period to illustrate its
importance:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-31"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">res_ws3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">spwb_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed_burnin</span>,</span>
<span>                    <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>, dates <span class="op">=</span> <span class="va">dates</span>, summary_frequency <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>                    watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"before"</span> <span class="op">=</span> <span class="va">res_ws1</span><span class="op">$</span><span class="va">watershed_balance</span><span class="op">$</span><span class="va">WatershedExport</span>, </span>
<span>           <span class="st">"after"</span> <span class="op">=</span> <span class="va">res_ws3</span><span class="op">$</span><span class="va">watershed_balance</span><span class="op">$</span><span class="va">WatershedExport</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         before     after</span></span>
<span><span class="co">## 1  0.073774376 0.3731846</span></span>
<span><span class="co">## 2  0.037852903 0.3327946</span></span>
<span><span class="co">## 3  0.000000000 0.2715065</span></span>
<span><span class="co">## 4  0.087832923 0.3926512</span></span>
<span><span class="co">## 5  0.028551537 0.3233051</span></span>
<span><span class="co">## 6  0.202421222 0.5931811</span></span>
<span><span class="co">## 7  0.000000000 0.3305984</span></span>
<span><span class="co">## 8  0.000000000 0.2612705</span></span>
<span><span class="co">## 9  0.000000000 0.2580586</span></span>
<span><span class="co">## 10 0.141107695 0.4860296</span></span>
<span><span class="co">## 11 0.090092361 0.4547424</span></span>
<span><span class="co">## 12 0.102705122 0.4643604</span></span>
<span><span class="co">## 13 0.001455222 0.3007647</span></span>
<span><span class="co">## 14 0.000000000 0.2752761</span></span>
<span><span class="co">## 15 0.000000000 0.2753467</span></span>
<span><span class="co">## 16 0.000000000 0.2716527</span></span>
<span><span class="co">## 17 0.000000000 0.2674355</span></span>
<span><span class="co">## 18 0.000000000 0.2645210</span></span>
<span><span class="co">## 19 0.000000000 0.2637802</span></span>
<span><span class="co">## 20 0.000000000 0.2644819</span></span>
<span><span class="co">## 21 0.122633540 0.4753295</span></span>
<span><span class="co">## 22 0.136742721 0.5118090</span></span>
<span><span class="co">## 23 0.007795713 0.3039228</span></span>
<span><span class="co">## 24 0.017187861 0.2902332</span></span>
<span><span class="co">## 25 0.018558367 0.2997559</span></span>
<span><span class="co">## 26 0.000000000 0.2814159</span></span>
<span><span class="co">## 27 0.009952749 0.2797189</span></span>
<span><span class="co">## 28 0.000000000 0.2753959</span></span>
<span><span class="co">## 29 0.000000000 0.2738947</span></span>
<span><span class="co">## 30 0.000000000 0.2687231</span></span>
<span><span class="co">## 31 0.000000000 0.2587818</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="simulations-of-watershed-forest-dynamics">Simulations of watershed forest dynamics<a class="anchor" aria-label="anchor" href="#simulations-of-watershed-forest-dynamics"></a>
</h3>
<p>Running <code><a href="../reference/spwb_land.html">growth_land()</a></code> is very similar to running
<code><a href="../reference/spwb_land.html">spwb_land()</a></code>. However, a few things change when we want to
simulate forest dynamics using <code><a href="../reference/spwb_land.html">fordyn_land()</a></code>. Regarding the
<code>sf</code> input, an additional column
<code>management_arguments</code> may be defined to specify the forest
management arguments (i.e. silviculture) of cells. Furthermore, the
function does not allow choosing the temporal scale of summaries. A call
to <code><a href="../reference/spwb_land.html">fordyn_land()</a></code> for a single year is given here:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_ws2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spwb_land.html">fordyn_land</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">example_watershed</span>,</span>
<span>                       <span class="va">SpParamsMED</span>, <span class="va">examplemeteo</span>,</span>
<span>                       watershed_control <span class="op">=</span> <span class="va">ws_control</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Creating 65 input objects for model 'growth'.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Creating 65 input objects for model 'growth'. <span style="color: #B2B2B2;">[12ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## Stands <span style="color: #00BB00;">■■■■■■■■■■■                     </span>  35% | ETA:  2s</span></span></code></pre>
<pre><code><span><span class="co">## Stands <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■    </span>  91% | ETA:  0s</span></span></code></pre>
<pre><code><span><span class="co">## Stands <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span>  98% | ETA:  0s</span></span></code></pre>
<p>In this case, the <code>sf</code> part of the output contains
additional columns, analogous to those of
<code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_ws2</span><span class="op">$</span><span class="va">sf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "geometry"         "state"            "aquifer"          "snowpack"        </span></span>
<span><span class="co">##  [5] "summary"          "forest"           "tree_table"       "shrub_table"     </span></span>
<span><span class="co">##  [9] "dead_tree_table"  "dead_shrub_table" "cut_tree_table"   "cut_shrub_table"</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Miquel De Cáceres, Aitor Améztegui, María González, Daniel Caviedes-Voullième, Mario Morales-Hernández.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
