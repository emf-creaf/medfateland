<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Management scenarios • medfateland</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Management scenarios">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">medfateland</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/PackageOverview.html">Package overview</a></li>
    <li><a class="dropdown-item" href="../articles/PreparingInputs_I.html">Preparing inputs I: forest inventory plots</a></li>
    <li><a class="dropdown-item" href="../articles/PreparingInputs_II.html">Preparing inputs II: arbitrary locations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Running simulation models</h6></li>
    <li><a class="dropdown-item" href="../articles/SpatiallyUncoupledSimulations.html">Spatially-uncoupled simulations</a></li>
    <li><a class="dropdown-item" href="../articles/WatershedSimulations.html">Watershed simulations</a></li>
    <li><a class="dropdown-item" href="../articles/ManagementScenarios.html">Management scenarios</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model analysis and parametrization</h6></li>
    <li><a class="dropdown-item" href="../articles/TetisWatershedParameters.html">Sensitivity to watershed parameters</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Management scenarios</h1>
                        <h4 data-toc-skip class="author">Miquel De
Caceres</h4>
            
            <h4 data-toc-skip class="date">2024-07-20</h4>
      

      <div class="d-none name"><code>ManagementScenarios.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="aim">Aim<a class="anchor" aria-label="anchor" href="#aim"></a>
</h2>
<p>The aim of this vignette is to illustrate how to use
<strong>medfateland</strong> (v. 2.4.4) to carry out simulations of
forest dynamics on a set of forest stands while evaluating a
demand-based management scenario. In particular, we will illustrate the
use of functions <code><a href="../reference/create_management_scenario.html">create_management_scenario()</a></code> and
<code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<div class="section level3">
<h3 id="forest-stands-topography-and-soils">Forest stands, topography and soils<a class="anchor" aria-label="anchor" href="#forest-stands-topography-and-soils"></a>
</h3>
<p>All simulations in <strong>medfateland</strong> an
<strong>sf</strong> object containing information of the topography,
soils and vegetation of a set of target forest stands. Here we begin by
loading the example data set of 100 forest stands distributed on points
in the landscape:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_ifn"</span><span class="op">)</span></span>
<span><span class="va">example_ifn</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 100 features and 7 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 1.817095 ymin: 41.93301 xmax: 2.142956 ymax: 41.99881</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 100 × 8</span></span></span>
<span><span class="co">##                   geom id        elevation slope aspect land_cover_type soil  </span></span>
<span><span class="co">##  <span style="color: #BCBCBC;">*</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (2.130641 41.99872) 081015_A1       680  7.73  281.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (2.142714 41.99881) 081016_A1       736 15.6   212.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (1.828998 41.98704) 081018_A1       532 17.6   291.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (1.841068 41.98716) 081019_A1       581  4.79  174.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> (1.853138 41.98728) 081020_A1       613  4.76   36.9 wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (1.901418 41.98775) 081021_A1       617 10.6   253.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (1.937629 41.98809) 081022_A1       622 20.6   360   wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  (1.949699 41.9882) 081023_A1       687 14.4   324.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  (1.96177 41.98831) 081024_A1       597 11.8    16.3 wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  (1.97384 41.98842) 081025_A1       577 14.6   348.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: forest &lt;list&gt;</span></span></span></code></pre>
<p>To speed-up simulations in this vignette we select only stands 31 to
40:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_subset</span> <span class="op">&lt;-</span> <span class="va">example_ifn</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">40</span>, <span class="op">]</span></span>
<span><span class="va">example_subset</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 10 features and 7 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 1.901727 ymin: 41.96974 xmax: 2.022399 ymax: 41.97083</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">##                   geom id        elevation slope aspect land_cover_type soil  </span></span>
<span><span class="co">##            <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (1.901727 41.96974) 081047_A1       478 12.0   259.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (1.925861 41.96997) 081048_A1       540 16.4   109.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (1.937928 41.97008) 081049_A1       636  7.65  263.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (1.949995 41.97019) 081050_A1       722 18.9   204.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  (1.962062 41.9703) 081051_A1       763  9.63  115.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (1.974129 41.97041) 081052_A1       642  9.32  156.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (1.986197 41.97052) 081053_A1       640 17.0   326.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (1.998264 41.97062) 081054_A1       552 10.6    88.7 wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (2.010331 41.97073) 081055_A1       593  5.73  265.  wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (2.022399 41.97083) 081056_A1       601  5.26   84.8 wildland        <span style="color: #949494;">&lt;df&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: forest &lt;list&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="climate-forcing">Climate forcing<a class="anchor" aria-label="anchor" href="#climate-forcing"></a>
</h3>
<p>In this example we will use, for simplicity, the same weather data
for all stands, but normal applications should address spatial variation
of weather. In the following code we prepare a three-year meteorological
data in two blocks (data frames), using the example weather data
provided in <strong>medfate</strong> package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"examplemeteo"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">meteo_01_02</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">examplemeteo</span>, <span class="va">examplemeteo</span><span class="op">)</span></span>
<span><span class="va">meteo_01_02</span><span class="op">$</span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2001-01-01"</span><span class="op">)</span>, </span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2002-12-31"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">meteo_03</span> <span class="op">&lt;-</span> <span class="va">examplemeteo</span></span>
<span><span class="va">meteo_03</span><span class="op">$</span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2003-01-01"</span><span class="op">)</span>, </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2003-12-31"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="management-prescriptions">Management prescriptions<a class="anchor" aria-label="anchor" href="#management-prescriptions"></a>
</h3>
<p>Management scenarios require classifying forest stands into
<em>management units</em>. Each management unit can be interpreted as a
set of stands that are managed following the same prescriptions.
Management units can be arbitrarily defined, but here we will define
them on the basis of dominant tree species. The following code allows
determining the dominant tree species in each of the 10 forest
stands:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_subset</span><span class="op">$</span><span class="va">dominant_tree_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">example_subset</span><span class="op">$</span><span class="va">forest</span>,</span>
<span>                                               <span class="va">stand_dominantTreeSpecies</span>, <span class="va">SpParamsMED</span><span class="op">)</span></span></code></pre></div>
<p>And the result is:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_subset</span><span class="op">$</span><span class="va">dominant_tree_species</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Pinus halepensis" "Pinus nigra"      "Quercus faginea"  "Pinus nigra"     </span></span>
<span><span class="co">##  [5] "Pinus nigra"      "Pinus halepensis" "Pinus nigra"      "Pinus nigra"     </span></span>
<span><span class="co">##  [9] "Pinus nigra"      "Pinus nigra"</span></span></code></pre>
<p>Package <strong>medfateland</strong> includes a table with default
prescription parameters for a set of species. This is loaded using:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"defaultPrescriptionsBySpecies"</span><span class="op">)</span></span></code></pre></div>
<p>The columns of this data frame are the same as the parameter names
required by function <code><a href="https://emf-creaf.github.io/medfate/reference/defaultManagementFunction.html" class="external-link">defaultManagementFunction()</a></code> of package
<strong>medfate</strong>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">defaultPrescriptionsBySpecies</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Name"                   "SpIndex"                "type"                  </span></span>
<span><span class="co">##  [4] "targetTreeSpecies"      "thinning"               "thinningMetric"        </span></span>
<span><span class="co">##  [7] "thinningThreshold"      "thinningPerc"           "minThinningInterval"   </span></span>
<span><span class="co">## [10] "yearsSinceThinning"     "finalMeanDBH"           "finalPerc"             </span></span>
<span><span class="co">## [13] "finalPreviousStage"     "finalYearsBetweenCuts"  "finalYearsToCut"       </span></span>
<span><span class="co">## [16] "plantingSpecies"        "plantingDBH"            "plantingHeight"        </span></span>
<span><span class="co">## [19] "plantingDensity"        "understoryMaximumCover"</span></span></code></pre>
<p>whereas the rows correspond to species or species groups, whose names
are:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">defaultPrescriptionsBySpecies</span><span class="op">$</span><span class="va">Name</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Abies/Picea/Pseudotsuga spp."           </span></span>
<span><span class="co">##  [2] "Betula/Acer spp."                       </span></span>
<span><span class="co">##  [3] "Castanea sativa"                        </span></span>
<span><span class="co">##  [4] "Eucalyptus spp."                        </span></span>
<span><span class="co">##  [5] "Fagus sylvatica"                        </span></span>
<span><span class="co">##  [6] "Fraxinus spp."                          </span></span>
<span><span class="co">##  [7] "Juniperus thurifera"                    </span></span>
<span><span class="co">##  [8] "Cupressus spp."                         </span></span>
<span><span class="co">##  [9] "Pinus halepensis"                       </span></span>
<span><span class="co">## [10] "Pinus nigra"                            </span></span>
<span><span class="co">## [11] "Pinus pinaster"                         </span></span>
<span><span class="co">## [12] "Pinus pinea"                            </span></span>
<span><span class="co">## [13] "Pinus radiata"                          </span></span>
<span><span class="co">## [14] "Pinus sylvestris"                       </span></span>
<span><span class="co">## [15] "Pinus uncinata"                         </span></span>
<span><span class="co">## [16] "Chamaecyparis lawsoniana"               </span></span>
<span><span class="co">## [17] "Thuja spp."                             </span></span>
<span><span class="co">## [18] "Larix spp."                             </span></span>
<span><span class="co">## [19] "Quercus ilex"                           </span></span>
<span><span class="co">## [20] "Quercus faginea"                        </span></span>
<span><span class="co">## [21] "Quercus suber"                          </span></span>
<span><span class="co">## [22] "Quercus robur/petraea/rubra/canariensis"</span></span>
<span><span class="co">## [23] "Quercus pyrenaica/pubescens"            </span></span>
<span><span class="co">## [24] "Platanus spp."                          </span></span>
<span><span class="co">## [25] "Populus spp."                           </span></span>
<span><span class="co">## [26] "Salix spp."                             </span></span>
<span><span class="co">## [27] "Otras frondosas"</span></span></code></pre>
<p>To specify the management unit for stands, we first define a column
<code>management_unit</code> with missing values and then assign the
corresponding row number of <code>defaultPrescriptionsBySpecies</code>
for stands dominated by each of the three species.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_subset</span><span class="op">$</span><span class="va">management_unit</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">example_subset</span><span class="op">$</span><span class="va">management_unit</span><span class="op">[</span><span class="va">example_subset</span><span class="op">$</span><span class="va">dominant_tree_species</span><span class="op">==</span><span class="st">"Pinus halepensis"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">9</span></span>
<span><span class="va">example_subset</span><span class="op">$</span><span class="va">management_unit</span><span class="op">[</span><span class="va">example_subset</span><span class="op">$</span><span class="va">dominant_tree_species</span><span class="op">==</span><span class="st">"Pinus nigra"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">example_subset</span><span class="op">$</span><span class="va">management_unit</span><span class="op">[</span><span class="va">example_subset</span><span class="op">$</span><span class="va">dominant_tree_species</span><span class="op">==</span><span class="st">"Pinus sylvestris"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">14</span></span>
<span><span class="va">example_subset</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"dominant_tree_species"</span>, <span class="st">"management_unit"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 10 features and 3 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 1.901727 ymin: 41.96974 xmax: 2.022399 ymax: 41.97083</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##    id        dominant_tree_species management_unit                geom</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 081047_A1 Pinus halepensis                    9 (1.901727 41.96974)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 081048_A1 Pinus nigra                        10 (1.925861 41.96997)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 081049_A1 Quercus faginea                    <span style="color: #BB0000;">NA</span> (1.937928 41.97008)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 081050_A1 Pinus nigra                        10 (1.949995 41.97019)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 081051_A1 Pinus nigra                        10  (1.962062 41.9703)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 081052_A1 Pinus halepensis                    9 (1.974129 41.97041)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 081053_A1 Pinus nigra                        10 (1.986197 41.97052)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 081054_A1 Pinus nigra                        10 (1.998264 41.97062)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 081055_A1 Pinus nigra                        10 (2.010331 41.97073)</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 081056_A1 Pinus nigra                        10 (2.022399 41.97083)</span></span></code></pre>
<p>The stands with missing values of <code>management_unit</code> (here
only one) will not be managed during simulations.</p>
</div>
<div class="section level3">
<h3 id="demand-based-management-scenario">Demand-based management scenario<a class="anchor" aria-label="anchor" href="#demand-based-management-scenario"></a>
</h3>
<p>Management scenarios are defined using function
<code><a href="../reference/create_management_scenario.html">create_management_scenario()</a></code>. Three different kinds of
scenarios are allowed. Two of them being demand-based, meaning that
management is constrained by a prescribed wood demand. The remaining one
allows actual management to freely the interplay of forest dynamics and
management prescriptions. Here we will define a demand-based scenario
with fixed demand values for all years of the simulation. The demand
will normally depend on the species available in the target stands and
the area they represent. In this example, we will require an annual
extraction of 2300 m3 of Pinus nigra or P. sylvestris and 1000 m3 of P.
halepensis:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_management_scenario.html">create_management_scenario</a></span><span class="op">(</span><span class="va">defaultPrescriptionsBySpecies</span>, </span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pinus nigra/Pinus sylvestris"</span> <span class="op">=</span> <span class="fl">1300</span>,</span>
<span>                                     <span class="st">"Pinus halepensis"</span> <span class="op">=</span> <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that we included the data frame
<code>defaultPrescriptionBySpecies</code> in our call to
<code><a href="../reference/create_management_scenario.html">create_management_scenario()</a></code>. This allows having the
sylvicultural prescriptions and other management parameters in a single
object. Simulations will assign management parameters using
<code>management_unit</code> column and the information in the
prescription data frame.</p>
<p>The scenario object is a list with the following elements.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">scen</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "scenario_type"            "annual_demand_by_species"</span></span>
<span><span class="co">## [3] "extraction_rate_by_year"  "units"</span></span></code></pre>
<p>The first one specifies the type of scenario, which in this case is
based on a fixed input demand:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span><span class="op">$</span><span class="va">scenario_type</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "input_demand"</span></span></code></pre>
<p>The next element contains the demand values we entered:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span><span class="op">$</span><span class="va">annual_demand_by_species</span></span></code></pre></div>
<pre><code><span><span class="co">## Pinus nigra/Pinus sylvestris             Pinus halepensis </span></span>
<span><span class="co">##                         1300                          500</span></span></code></pre>
<p>The following element is NULL in this case, since it is used to
specify demand-based scenarios where actual demand depends on observed
growth and a desired rate of extraction:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span><span class="op">$</span><span class="va">extraction_rate_by_year</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<p>Finally, element <code>units</code> contains the data frame of
management units, which in our case is
<code>defaultPrescriptionBySpecies</code>.</p>
<p>Normally, we will not need to modify management parameters, but here
we will make thinning operations more likely for all three species by
lowering the basal area threshold that triggers them:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span><span class="op">$</span><span class="va">units</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">14</span><span class="op">)</span>,<span class="st">"thinningThreshold"</span><span class="op">]</span> <span class="op">&lt;-</span><span class="fl">20</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="area-represented-by-forest-stands">Area represented by forest stands<a class="anchor" aria-label="anchor" href="#area-represented-by-forest-stands"></a>
</h3>
<p>Before running simulations, it is necessary to specify the area (in
ha) that each forest stand represents. This is important, because all
wood volumes are defined at the stand level in units of m3/ha. Hence, we
need to multiply these values for the actual area that the stand
represents, in order to know how much of the demand is fulfilled</p>
<p>In this example, we will assume a constant area of 100 ha for all
stands:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_subset</span><span class="op">$</span><span class="va">represented_area_ha</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="carrying-out-simulations">Carrying out simulations<a class="anchor" aria-label="anchor" href="#carrying-out-simulations"></a>
</h2>
<p>We are now ready to launch the simulation of the management scenario.
This is done using a call to function <code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code>. As
other simulation functions of <strong>medfateland</strong>, we need to
supply the <code>sf</code> object, a table of species parameter values
and the source of weather information. We also specify the management
scenario and set <code>parallelize = TRUE</code> to speed-up
calculations. This last parameter will also be important in real-case
simulations.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fordyn_scenario.html">fordyn_scenario</a></span><span class="op">(</span><span class="va">example_subset</span>, <span class="va">SpParamsMED</span>, meteo <span class="op">=</span> <span class="va">meteo_01_02</span>, </span>
<span>                         management_scenario <span class="op">=</span> <span class="va">scen</span>,</span>
<span>                         parallelize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Simulation of a management/fire scenario with fordyn</span> <span style="color: #00BBBB;">────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking sf input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking sf input <span style="color: #B2B2B2;">[7ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking meteo object input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking meteo object input <span style="color: #B2B2B2;">[16ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Scenario parameters</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## • Number of stands: 10</span></span></code></pre>
<pre><code><span><span class="co">## • Represented area: 1000 ha</span></span></code></pre>
<pre><code><span><span class="co">## • Number of years: 2</span></span></code></pre>
<pre><code><span><span class="co">## • Management scenario type: input_demand</span></span></code></pre>
<pre><code><span><span class="co">## • Adding column 'management_arguments'</span></span></code></pre>
<pre><code><span><span class="co">## • Default volume function</span></span></code></pre>
<pre><code><span><span class="co">## • Initial volume: 66449 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Seed dispersal process included.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Simulation</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ──  [ Year 2001 (1/2) ]</span></span></code></pre>
<pre><code><span><span class="co">## • Demand (incl. offset): 1800 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Determining available volumes and final cuts</span></span></code></pre>
<pre><code><span><span class="co">## • Demand (after final cuts): 1800 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Determining thinning operations</span></span></code></pre>
<pre><code><span><span class="co">## • Seed bank dynamics and seed dispersal...</span></span></code></pre>
<pre><code><span><span class="co">## • Calling fordyn_spatial...</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking sf input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking sf input <span style="color: #B2B2B2;">[8ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking meteo object input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking meteo object input <span style="color: #B2B2B2;">[11ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Preparing data for parallelization</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Preparing data for parallelization <span style="color: #B2B2B2;">[18ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Launching parallel computation (cores = 7; chunk size = 2)</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Launching parallel computation (cores = 7; chunk size = 2) <span style="color: #B2B2B2;">[20.3s]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Retrieval of results</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Retrieval of results <span style="color: #B2B2B2;">[15ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> No simulation errors detected</span></span></code></pre>
<pre><code><span><span class="co">## • Final volume: 64806 m3</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ──  [ Year 2002 (2/2) ]</span></span></code></pre>
<pre><code><span><span class="co">## • Demand (incl. offset): 2754 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Determining available volumes and final cuts</span></span></code></pre>
<pre><code><span><span class="co">## • Demand (after final cuts): 2754 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Determining thinning operations</span></span></code></pre>
<pre><code><span><span class="co">## • Seed bank dynamics and seed dispersal...</span></span></code></pre>
<pre><code><span><span class="co">## • Calling fordyn_spatial...</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking sf input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking sf input <span style="color: #B2B2B2;">[8ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking meteo object input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking meteo object input <span style="color: #B2B2B2;">[13ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Preparing data for parallelization</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Preparing data for parallelization <span style="color: #B2B2B2;">[12ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Launching parallel computation (cores = 7; chunk size = 2)</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Launching parallel computation (cores = 7; chunk size = 2) <span style="color: #B2B2B2;">[14.1s]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Retrieval of results</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Retrieval of results <span style="color: #B2B2B2;">[18ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> No simulation errors detected</span></span></code></pre>
<pre><code><span><span class="co">## • Final volume: 63630 m3</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Arranging output</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## • Tree/shrub tables</span></span></code></pre>
<pre><code><span><span class="co">## • Wood volume table</span></span></code></pre>
<p>Given that it is a long process, the function produces a lot of
output (this can be turned of if <code>progress = FALSE</code>). First,
the scenario parameters are presented, including the scenario type, the
specified demand and the number of forest stands in each management
unit. Then, the output is produced for each year, where the function
first decides and reports how many forest stands will be simulated and,
after these are completed, it summarizes the results.</p>
<p>Function <code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code> returns a list whose elements
are:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fs_12</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "result_sf"             "result_volumes"        "result_volumes_spp"   </span></span>
<span><span class="co">## [4] "result_volumes_demand" "next_demand"           "next_sf"</span></span></code></pre>
<p>The first four elements, those named <code>result_*</code> contain
the actual simulation results, whereas the last two elements are used
for subsequent simulations (see next section).</p>
<p>Stand-level results are available in element <code>result_sf</code>.
The column names of this <code>sf</code> object should be easy to
interpret if you have experience with functions <code><a href="https://emf-creaf.github.io/medfate/reference/fordyn.html" class="external-link">fordyn()</a></code> or
<code><a href="../reference/spwb_spatial.html">fordyn_spatial()</a></code>:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span><span class="op">$</span><span class="va">result_sf</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 10 features and 8 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 1.901727 ymin: 41.96974 xmax: 2.022399 ymax: 41.97083</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 9</span></span></span>
<span><span class="co">##               geometry id        tree_table         shrub_table dead_tree_table</span></span>
<span><span class="co">##            <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (1.901727 41.96974) 081047_A1 <span style="color: #949494;">&lt;tibble [50 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (1.925861 41.96997) 081048_A1 <span style="color: #949494;">&lt;tibble [45 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (1.937928 41.97008) 081049_A1 <span style="color: #949494;">&lt;tibble [15 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (1.949995 41.97019) 081050_A1 <span style="color: #949494;">&lt;tibble [47 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  (1.962062 41.9703) 081051_A1 <span style="color: #949494;">&lt;tibble [38 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (1.974129 41.97041) 081052_A1 <span style="color: #949494;">&lt;tibble [56 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (1.986197 41.97052) 081053_A1 <span style="color: #949494;">&lt;tibble [61 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (1.998264 41.97062) 081054_A1 <span style="color: #949494;">&lt;tibble [72 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (2.010331 41.97073) 081055_A1 <span style="color: #949494;">&lt;tibble [39 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (2.022399 41.97083) 081056_A1 <span style="color: #949494;">&lt;tibble [64 × 10]&gt;</span> <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #949494;">&lt;tibble&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 more variables: dead_shrub_table &lt;list&gt;, cut_tree_table &lt;list&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   cut_shrub_table &lt;list&gt;, summary &lt;list&gt;</span></span></span></code></pre>
<p>Another important element of the results is
<code>result_volumes</code>, which contains several volumes statistics
(in m3) summarizing what happened each year of the simulation.</p>
<p>First, we can inspect for each year the volume corresponding to the
initial and final standing stock, the forest growth and the extracted
wood:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span><span class="op">$</span><span class="va">result_volumes</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">##    Year initial growth mortality extracted  final cumulative_growth</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>001  <span style="text-decoration: underline;">66</span>449.  <span style="text-decoration: underline;">1</span>616.      52.7     <span style="text-decoration: underline;">3</span>206. <span style="text-decoration: underline;">64</span>806.             <span style="text-decoration: underline;">1</span>616.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>002  <span style="text-decoration: underline;">64</span>806.  <span style="text-decoration: underline;">1</span>551.      49.9     <span style="text-decoration: underline;">2</span>677. <span style="text-decoration: underline;">63</span>630.             <span style="text-decoration: underline;">3</span>167.</span></span></code></pre>
<p>The same figures can be inspected, but corresponding to those species
for which demand has been defined:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span><span class="op">$</span><span class="va">result_volumes</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">##    Year cumulative_extraction initial_target growth_target mortality_target</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>001                 <span style="text-decoration: underline;">3</span>206.         <span style="text-decoration: underline;">62</span>682.         <span style="text-decoration: underline;">1</span>592.             48.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>002                 <span style="text-decoration: underline;">5</span>883.         <span style="text-decoration: underline;">63</span>380.         <span style="text-decoration: underline;">1</span>537.             48.9</span></span></code></pre>
<p>Finally, we can display for each step what was the nominal demand
(according to the input), the actual demand (once the offset of previous
years was included), as well as the cumulative nominal demand and
cumulative extracted volumes. While strong disagreements can exist
between demand and extracted wood at the annual level, the cumulative
columns mentioned are important to check whether simulations fulfilled
the required demand in the long term.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span><span class="op">$</span><span class="va">result_volumes</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">##    Year extracted_target final_target nominal_demand demand_offset actual_demand</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>001             846.       <span style="text-decoration: underline;">64</span>806.           <span style="text-decoration: underline;">1</span>800            0          <span style="text-decoration: underline;">1</span>800 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>002            <span style="text-decoration: underline;">2</span>677.       <span style="text-decoration: underline;">63</span>630.           <span style="text-decoration: underline;">1</span>800          954.         <span style="text-decoration: underline;">2</span>754.</span></span></code></pre>
<div class="section level3">
<h3 id="continuing-a-previous-simulation">Continuing a previous simulation<a class="anchor" aria-label="anchor" href="#continuing-a-previous-simulation"></a>
</h3>
<p>As mentioned above, other elements of the output of
<code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code> allow conducting a new scenario
simulation starting at the point where the previous one finished. The
element <code>next_sf</code> contains the <code>sf</code> object
corresponding to the final state of the simulation:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span><span class="op">$</span><span class="va">next_sf</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 10 features and 12 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 1.901727 ymin: 41.96974 xmax: 2.022399 ymax: 41.97083</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 13</span></span></span>
<span><span class="co">##                   geom id        elevation slope aspect land_cover_type soil  </span></span>
<span><span class="co">##  <span style="color: #BCBCBC;">*</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> (1.901727 41.96974) 081047_A1       478 12.0   259.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> (1.925861 41.96997) 081048_A1       540 16.4   109.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> (1.937928 41.97008) 081049_A1       636  7.65  263.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> (1.949995 41.97019) 081050_A1       722 18.9   204.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  (1.962062 41.9703) 081051_A1       763  9.63  115.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> (1.974129 41.97041) 081052_A1       642  9.32  156.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> (1.986197 41.97052) 081053_A1       640 17.0   326.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> (1.998264 41.97062) 081054_A1       552 10.6    88.7 wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> (2.010331 41.97073) 081055_A1       593  5.73  265.  wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> (2.022399 41.97083) 081056_A1       601  5.26   84.8 wildland        <span style="color: #949494;">&lt;soil&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: forest &lt;list&gt;, dominant_tree_species &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   management_unit &lt;dbl&gt;, represented_area_ha &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   management_arguments &lt;list&gt;, state &lt;list&gt;</span></span></span></code></pre>
<p>On the other hand, in demand-based scenarios there may be demand
offsets that need to be carried on to the next simulations:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_12</span><span class="op">$</span><span class="va">next_demand</span></span></code></pre></div>
<pre><code><span><span class="co">## $offset</span></span>
<span><span class="co">## Pinus nigra/Pinus sylvestris             Pinus halepensis </span></span>
<span><span class="co">##                    -107.0978                     183.7386 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $last_growth</span></span>
<span><span class="co">## [1] 1536.609</span></span></code></pre>
<p>In addition to the demand offset for each species or species group,
note that <code>next_demand</code> also contains information about the
last growth. This is necessary for scenarios where demand is modulated
depending on intended extraction rates and past growth.</p>
<p>If we want to carry on simulations for an extra time period (one year
in our example), we can simply call <code><a href="../reference/fordyn_scenario.html">fordyn_scenario()</a></code> along
with the result of the previous simulation instead of the original
<code>sf</code> object:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fordyn_scenario.html">fordyn_scenario</a></span><span class="op">(</span><span class="va">fs_12</span>, <span class="va">SpParamsMED</span>, meteo <span class="op">=</span> <span class="va">meteo_03</span>, </span>
<span>                        management_scenario <span class="op">=</span> <span class="va">scen</span>,</span>
<span>                        parallelize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Simulation of a management/fire scenario with fordyn</span> <span style="color: #00BBBB;">────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Recovering previous run</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Recovering previous run <span style="color: #B2B2B2;">[4ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking sf input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking sf input <span style="color: #B2B2B2;">[10ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking meteo object input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking meteo object input <span style="color: #B2B2B2;">[10ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Scenario parameters</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## • Number of stands: 10</span></span></code></pre>
<pre><code><span><span class="co">## • Represented area: 1000 ha</span></span></code></pre>
<pre><code><span><span class="co">## • Number of years: 1</span></span></code></pre>
<pre><code><span><span class="co">## • Management scenario type: input_demand</span></span></code></pre>
<pre><code><span><span class="co">## • Default volume function</span></span></code></pre>
<pre><code><span><span class="co">## • Initial volume: 63630 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Seed dispersal process included.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Simulation</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ──  [ Year 2003 (1/1) ]</span></span></code></pre>
<pre><code><span><span class="co">## • Demand (incl. offset): 1877 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Determining available volumes and final cuts</span></span></code></pre>
<pre><code><span><span class="co">## • Demand (after final cuts): 1877 m3</span></span></code></pre>
<pre><code><span><span class="co">## • Determining thinning operations</span></span></code></pre>
<pre><code><span><span class="co">## • Seed bank dynamics and seed dispersal...</span></span></code></pre>
<pre><code><span><span class="co">## • Calling fordyn_spatial...</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking sf input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking sf input <span style="color: #B2B2B2;">[7ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Checking meteo object input</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Checking meteo object input <span style="color: #B2B2B2;">[13ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Preparing data for parallelization</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Preparing data for parallelization <span style="color: #B2B2B2;">[16ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Launching parallel computation (cores = 7; chunk size = 2)</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Launching parallel computation (cores = 7; chunk size = 2) <span style="color: #B2B2B2;">[16s]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Retrieval of results</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Retrieval of results <span style="color: #B2B2B2;">[13ms]</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> No simulation errors detected</span></span></code></pre>
<pre><code><span><span class="co">## • Final volume: 65105 m3</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Arranging output</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## • Tree/shrub tables</span></span></code></pre>
<pre><code><span><span class="co">## • Wood volume table</span></span></code></pre>
<p>Note that in this case, the initial output makes explicit that a
previous simulation is continued.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Aitor Améztegui, María González, Núria Aquilué, Daniel Caviedes-Voullième, Mario Morales-Hernández.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
